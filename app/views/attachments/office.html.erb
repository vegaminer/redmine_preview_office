<%= render :layout => 'layouts/file' do %>
  <script type="text/javascript">  
       // $(document).ready(function(){	  
     function setPreviewSrc( aSrc ) {
        console.log( aSrc );
		// Opera 8.0+
		var isOpera = (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;

		// Firefox 1.0+
		var isFirefox = typeof InstallTrigger !== 'undefined';

		// Safari 3.0+ "[object HTMLElementConstructor]" 
		var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification));

		// Internet Explorer 6-11
		var isIE = /*@cc_on!@*/false || !!document.documentMode;

		// Edge 20+
		var isEdge = !isIE && !!window.StyleMedia;

		// Chrome 1 - 79
		var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);

		// Edge (based on chromium) detection
		var isEdgeChromium = isChrome && (navigator.userAgent.indexOf("Edg") != -1);

		// Blink engine detection
		var isBlink = (isChrome || isOpera) && !!window.CSS;

		var iframe = $('#iframe_preview');
		var embed  = $('#embed_preview');

		var removeEmbed = embed && !isFirefox;
		var removeIframe = !removeEmbed;

		if ( removeEmbed ) {
			embed.remove();
		}
        else {
            $('#embed_href').attr( 'href', aSrc );
            $('#embed_data').attr( 'data', aSrc );            
        }

		if ( removeIframe ) {
			iframe.remove();
		}
		else {
			$('#iframe_src').attr( 'src', aSrc );
        }
	};

	function resizeObject(obj) {
	 // obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
	}

  </script>
  <%= preview_office_tag @attachment %>
<% end %>
